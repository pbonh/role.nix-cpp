- name: CMake | Install cmake | lineinfile
  changed_when: false
  lineinfile:
    path: "{{ nix_config }}"
    insertbefore: ".* Language Servers End .*"
    line: "cmake"

- name: CMake | Install CMake Plugin for Neovim | lineinfile
  changed_when: false
  lineinfile:
    path: "{{ nvim_init }}"
    insertbefore: ".*Language Server Protocol Providers\\(End\\).*"
    line: "Plug 'Shatur/neovim-cmake'"

- name: CMake | Configure cmake for Neovim | blockinfile
  changed_when: false
  blockinfile:
    path: "{{ nvim_init }}"
    marker: "// !-- {mark} CMake Config --"
    insertbefore: ".*Extra Plugin Settings\\(End\\).*"
    block: |
      lua << EOF
          require('telescope').load_extension('cmake')
      EOF

